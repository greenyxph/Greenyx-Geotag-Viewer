<script>
  async function loadImage() {
    const rsbsa = document.getElementById('rsbsaInput').value.trim();
    const scriptBase = 'https://script.google.com/macros/s/AKfycbyKZbjdnkTzP9gylUeUFsvEplKBUl0zC3LdHM1qC8KM04xh7G4Cevi1rXstykQEzOh7/exec';

    if (!rsbsa) {
      document.getElementById('imageContainer').innerHTML = '<p class="error">Please enter a valid RSBSA number.</p>';
      return;
    }

    const response = await fetch(`${scriptBase}?rsbsa=${encodeURIComponent(rsbsa)}`);
    const imageUrl = await response.text();

    const container = document.getElementById('imageContainer');
    if (imageUrl.startsWith('http')) {
      container.innerHTML = `
        <p><strong>Image Link:</strong> <a href="${imageUrl}" target="_blank">${imageUrl}</a></p>
        <img src="${imageUrl}" alt="RSBSA ${rsbsa}" width="300">
      `;
    } else {
      container.innerHTML = `<p class="error">Walang larawang nahanap para sa RSBSA ${rsbsa}.</p>`;
    }
  }

  function handleError(rsbsa) {
    document.getElementById('imageContainer').innerHTML = `<p class="error">Walang larawang nahanap para sa RSBSA ${rsbsa}.</p>`;
  }
</script>
